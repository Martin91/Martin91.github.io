
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Martin</title>
	<meta name="author" content="Martin">

	
	<meta name="description" content=" 最近一段时间，写了两篇关于 sidekiq 的源码分析，但是一直想要补充的一段 sidekiq 里边的代码其实是挺有趣也挺逗的，所以这个星期就不要长篇大论的源码分析，来点轻松点的吧。 Read on &rarr; Nov 26th, 2016 程序猿, 笑点, 趣味 Comments ">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Martin" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="/javascripts/jquery-1.11.1.min.js"></script>
	
</head>


<body>
	<header id="header" class="inner"><h1><a href="/">Martin</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:Martin91.github.io">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		
		
    
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
    
	</div>
	<form class="search" action="http://google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:Martin91.github.io">
	</form>
</nav>

</header>
	
		
	
	<div id="content" class="inner">


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/articles/2016/11/26/zhou-mo-dao-le-lai-duan-dai-ma-ya-ya-jing/">
		
			周末到了，来段代码压压惊</a>
	</h2>
	<div class="entry-content">
		<p>最近一段时间，写了两篇关于 sidekiq 的源码分析，但是一直想要补充的一段 sidekiq 里边的代码其实是挺有趣也挺逗的，所以这个星期就不要长篇大论的源码分析，来点轻松点的吧。</p>


		
		<a href="/blog/articles/2016/11/26/zhou-mo-dao-le-lai-duan-dai-ma-ya-ya-jing/" class="more-link">Read on &rarr;</a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2016-11-26T21:43:30+08:00" pubdate data-updated="true">Nov 26<span>th</span>, 2016</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/cheng-xu-yuan/'>程序猿</a>, <a class='category' href='/blog/categories/xiao-dian/'>笑点</a>, <a class='category' href='/blog/categories/qu-wei/'>趣味</a>


</div>
	
	<div class="comments"><a href="/blog/articles/2016/11/26/zhou-mo-dao-le-lai-duan-dai-ma-ya-ya-jing/#disqus_thread">Comments</a></div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/articles/2016/11/20/sidekiq-xin-hao-chu-li-yuan-ma-fen-xi/">
		
			Sidekiq 信号处理源码分析</a>
	</h2>
	<div class="entry-content">
		<h3>引言</h3>

<p>在之前的文章<a href="/blog/articles/2016/10/29/sidekiqren-wu-diao-du-liu-cheng-fen-xi/">《Sidekiq任务调度流程分析》</a>中，我们一起仔细分析了 Sidekiq 是如何基于多线程完成队列任务处理以及调度的。我们在之前的分析里，看到了不管是 <code>Sidekiq::Scheduled::Poller</code> 还是 <code>Sidekiq::Processor</code> 的核心代码里，都会有一个由 <code>@done</code> 实例变量控制的循环体：</p>


		
		<a href="/blog/articles/2016/11/20/sidekiq-xin-hao-chu-li-yuan-ma-fen-xi/" class="more-link">Read on &rarr;</a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2016-11-20T10:08:07+08:00" pubdate data-updated="true">Nov 20<span>th</span>, 2016</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/sidekiq/'>sidekiq</a>, <a class='category' href='/blog/categories/xin-hao-chu-li/'>信号处理</a>, <a class='category' href='/blog/categories/xian-cheng-guan-li/'>线程管理</a>


</div>
	
	<div class="comments"><a href="/blog/articles/2016/11/20/sidekiq-xin-hao-chu-li-yuan-ma-fen-xi/#disqus_thread">Comments</a></div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/articles/2016/10/29/sidekiqren-wu-diao-du-liu-cheng-fen-xi/">
		
			Sidekiq任务调度流程分析</a>
	</h2>
	<div class="entry-content">
		<p><a href="http://sidekiq.org/">sidekiq</a>是 Ruby 中一个非常优秀而且可靠的后台任务处理软件，其依赖 Redis 实现队列任务的增加、重试以及调度等。而 sidekiq 从启动到开始不断处理任务、定时任务以及失败任务的重试，都是如何调度的呢？遇到问题的时候，又该如何调优呢？</p>


		
		<a href="/blog/articles/2016/10/29/sidekiqren-wu-diao-du-liu-cheng-fen-xi/" class="more-link">Read on &rarr;</a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2016-10-29T16:32:28+08:00" pubdate data-updated="true">Oct 29<span>th</span>, 2016</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/sidekiq/'>sidekiq</a>, <a class='category' href='/blog/categories/ren-wu-diao-du/'>任务调度</a>, <a class='category' href='/blog/categories/hou-tai-ren-wu/'>后台任务</a>


</div>
	
	<div class="comments"><a href="/blog/articles/2016/10/29/sidekiqren-wu-diao-du-liu-cheng-fen-xi/#disqus_thread">Comments</a></div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/articles/2016/01/17/pay-attention-to-your-double-equals/">
		
			嘿，小心你的双等号==</a>
	</h2>
	<div class="entry-content">
		<p>前两天在写代码的时候，突然收到警告说项目代码中存在 XSS 漏洞，遂立即根据报告的 URL 排查页面代码，虽然很快就修复了，而且同样问题的讨论两年前就有了，看<a href="https://ruby-china.org/topics/16633">RubyChina: 别用 raw 和 html_safe</a>，一般来说相对有经验的老鸟也应该都知道这个点，但是还是觉得有必要写出来，再次提醒一下其他小伙伴，避免踩坑。</p>


		
		<a href="/blog/articles/2016/01/17/pay-attention-to-your-double-equals/" class="more-link">Read on &rarr;</a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2016-01-17T01:40:48+08:00" pubdate data-updated="true">Jan 17<span>th</span>, 2016</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/rails/'>rails</a>, <a class='category' href='/blog/categories/keng/'>坑</a>, <a class='category' href='/blog/categories/mo-ban/'>模板</a>, <a class='category' href='/blog/categories/xian-jing/'>陷阱</a>


</div>
	
	<div class="comments"><a href="/blog/articles/2016/01/17/pay-attention-to-your-double-equals/#disqus_thread">Comments</a></div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/articles/2015/10/30/jin-fang-activesupport-cache-store-huan-cun-nil-zhi/">
		
			谨防 ActiveSupport::Cache::Store 缓存 Nil 值</a>
	</h2>
	<div class="entry-content">
		<p>Rails 中的 <strong><a href="https://github.com/rails/rails/tree/master/activesupport">active_support</a></strong> 组件主要基于 Rails 需要提供了很多非常有用的基础工具以及对 Ruby 内置类进行扩展。其中的 cache 模块主要提供了 Rails 中底层缓存的定义以及简单实现。今天要跟大家探讨的是之前在使用此模块所遇到的一个坑，有兴趣学习其基本用法的可以点击以下两个链接：</p>

<ul>
<li><a href="http://guides.rubyonrails.org/caching_with_rails.html#activesupport-cache-store">Rails Guides: ActiveSupport::Cache::Store</a></li>
<li><a href="http://api.rubyonrails.org/classes/ActiveSupport/Cache/Store.html">Rails API: ActiveSupport::Cache::Store</a></li>
</ul>



		
		<a href="/blog/articles/2015/10/30/jin-fang-activesupport-cache-store-huan-cun-nil-zhi/" class="more-link">Read on &rarr;</a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-10-30T20:48:41+08:00" pubdate data-updated="true">Oct 30<span>th</span>, 2015</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/active-support/'>active_support</a>, <a class='category' href='/blog/categories/rails/'>rails</a>, <a class='category' href='/blog/categories/tricks/'>tricks</a>, <a class='category' href='/blog/categories/keng/'>坑</a>, <a class='category' href='/blog/categories/xian-jing/'>陷阱</a>


</div>
	
	<div class="comments"><a href="/blog/articles/2015/10/30/jin-fang-activesupport-cache-store-huan-cun-nil-zhi/#disqus_thread">Comments</a></div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/articles/2015/10/21/use-chinese-pinyin-and-friendly-id-to-generate-slugs/">
		
			使用 Chinese_pinyin + Friendly_id 为中文标题生成 Slug</a>
	</h2>
	<div class="entry-content">
		<p>在许多项目中，我们可能都会遇到需要为数据生成 slug 的场景，这些场景类似于：</p>

<ul>
<li>基于商品名称生成 slug</li>
<li>基于文章标题生成 slug</li>
</ul>


<p>至于为什么需要生成 slug，而不是使用比如 Rails 中默认自增的主键也就是数据的 id，原因其实很简单：</p>

<ul>
<li>使用自增 id 容易暴露数据，比如通过订单 id 可能导致遍历所有订单，不信，你看这里就有个<a href="http://www.wooyun.org/bugs/wooyun-2015-0127301">例子</a></li>
<li>增加 URL 友好性，/products/18376 这样的链接肯定没有比 /products/apple-watch-gold 这样的链接更招人喜欢</li>
</ul>



		
		<a href="/blog/articles/2015/10/21/use-chinese-pinyin-and-friendly-id-to-generate-slugs/" class="more-link">Read on &rarr;</a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-10-21T22:20:07+08:00" pubdate data-updated="true">Oct 21<span>st</span>, 2015</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/slug-generation-friendly/'>slug generation friendly</a>


</div>
	
	<div class="comments"><a href="/blog/articles/2015/10/21/use-chinese-pinyin-and-friendly-id-to-generate-slugs/#disqus_thread">Comments</a></div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/articles/2015/09/13/mysql-in-query-and-order-by-field-function/">
		
			MySQL in 查询，并通过 FIELD 函数按照查询条件顺序返回结果</a>
	</h2>
	<div class="entry-content">
		<p>我们都非常习惯通过 MySQL 的 <a href="https://dev.mysql.com/doc/refman/5.0/en/comparison-operators.html#function_in">IN 函数</a>来查询特定集合的数据，比如为了在 books 表中找出李雷、韩梅梅和安华写的书，我们可以有如下的 SQL（可以通过 <a href="http://sqlfiddle.com/#!9/1982d">SQL Fiddle</a>查看示例）：</p>


		
		<a href="/blog/articles/2015/09/13/mysql-in-query-and-order-by-field-function/" class="more-link">Read on &rarr;</a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-09-13T20:24:07+08:00" pubdate data-updated="true">Sep 13<span>th</span>, 2015</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/mysql-database-order-query/'>MySQL Database order Query</a>


</div>
	
	<div class="comments"><a href="/blog/articles/2015/09/13/mysql-in-query-and-order-by-field-function/#disqus_thread">Comments</a></div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/articles/2015/07/30/the-correct-way-to-metric-server-response-time/">
		
			Apdex——衡量服务器性能的标准</a>
	</h2>
	<div class="entry-content">
		<p>日常工作中，我们总是习惯于通过量化的标准去衡量我们对事物的评价，比如美食点评的星级、酒店的星级、每个个人的信用评分等等。而作为一个 Web 工程师，我们也总是在意于我们网站的性能，因为网站的性能会最直接地影响用户的体验。今天要介绍的就是一种同样能够帮助工程师对应用性能进行量化评估的标准 —— Apdex 。</p>


		
		<a href="/blog/articles/2015/07/30/the-correct-way-to-metric-server-response-time/" class="more-link">Read on &rarr;</a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-07-30T12:12:07+08:00" pubdate data-updated="true">Jul 30<span>th</span>, 2015</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/apdex-server-performance-fu-wu-qi-xing-neng/'>Apdex server performance 服务器 性能</a>


</div>
	
	<div class="comments"><a href="/blog/articles/2015/07/30/the-correct-way-to-metric-server-response-time/#disqus_thread">Comments</a></div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/articles/2015/03/28/shen-qing-yi-ji-ji-cheng-stripe-de-alipay-zhi-fu-fang-an/">
		
			申请以及集成 Stripe 的 Alipay 支付方案</a>
	</h2>
	<div class="entry-content">
		<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;最近在一个项目需要支持人民币支付，并且客户要求希望能够收完款后的结算是用美元，所以就想到了去年 Stripe 宣布已经跟支付宝达成合作意向，所以经过一番咨询跟集成，终于把 Stripe 集成进来，并且启用了支付宝收款。这篇文章介绍功能申请以及集成的完整过程。</p>


		
		<a href="/blog/articles/2015/03/28/shen-qing-yi-ji-ji-cheng-stripe-de-alipay-zhi-fu-fang-an/" class="more-link">Read on &rarr;</a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-03-28T12:12:07+08:00" pubdate data-updated="true">Mar 28<span>th</span>, 2015</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/stripe-payment-alipay-zhi-fu/'>stripe payment alipay 支付</a>


</div>
	
	<div class="comments"><a href="/blog/articles/2015/03/28/shen-qing-yi-ji-ji-cheng-stripe-de-alipay-zhi-fu-fang-an/#disqus_thread">Comments</a></div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/articles/2015/01/10/how-do-i-fix-passenger-application-startup-problem/">
		
			How Do I Fix Passenger Application Startup Problem</a>
	</h2>
	<div class="entry-content">
		<p>Recent days I was working on deploying one of my Rails project on a complete new VPS. I had operated according to my experience for deploying sites before, but at the last step, after I have deployed the site, it always raised error message &ldquo;An error occurred while starting up the preloader: it did not write a startup response in time.&rdquo; when I try to visit the site. But, thanks to much hard work and retry, I found the source of the problem and finally fix it.</p>

<p>I will spend short time to show the main steps to resolve the problem. Let&rsquo;s GO!</p>


		
		<a href="/blog/articles/2015/01/10/how-do-i-fix-passenger-application-startup-problem/" class="more-link">Read on &rarr;</a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-01-10T01:54:35+08:00" pubdate data-updated="true">Jan 10<span>th</span>, 2015</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/deploy/'>Deploy</a>, <a class='category' href='/blog/categories/passenger/'>Passenger</a>


</div>
	
	<div class="comments"><a href="/blog/articles/2015/01/10/how-do-i-fix-passenger-application-startup-problem/#disqus_thread">Comments</a></div>
	
</div>
</article>

<nav id="pagenavi">
    
    
        <a href="/blog/page/2/" class="next">Next</a>
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav></div>
	<footer id="footer" class="inner">Copyright &copy; 2016

    Martin

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'martin-blog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//go.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>




<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F6d4498d8e2d7328fffdb1539f0589a61' type='text/javascript'%3E%3C/script%3E"));
</script>
<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '781315158664022',
      xfbml      : true,
      version    : 'v2.4'
    });
  };

  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "//connect.facebook.net/en_US/sdk.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
</script>

</body>
</html>