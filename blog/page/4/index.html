
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Martin</title>
	<meta name="author" content="Martin">

	
	<meta name="description" content="In rails, there is normally a view corresponding to an action. So if you want to do some special styles based on different pages, you can render &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Martin" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="/javascripts/jquery-1.11.1.min.js"></script>
	
</head>


<body>
	<header id="header" class="inner"><h1><a href="/">Martin</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:Martin91.github.io">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		
		
    
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
    
	</div>
	<form class="search" action="http://google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:Martin91.github.io">
	</form>
</nav>

</header>
	
		
	
	<div id="content" class="inner">


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/articles/2013/08/29/write-css-codes-distinct-from-different-pages/">
		
			Write Css Codes Distinct From Different Pages</a>
	</h2>
	<div class="entry-content">
		<p>In rails, there is normally a view corresponding to an action. So if you want to do some special styles based on different pages, you can render controller name and action name in your layout file like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;body</span> <span class="na">class=</span><span class="s">&quot;#{controller_name} #{action_name}&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="c">&lt;!-- Render something --&gt;</span>
</span><span class='line'><span class="nt">&lt;/body&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Let&rsquo;s assumpt that your current page controller is <code>ProductsController</code>, and your action is <code>index</code>, then you can write your style codes like:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='scss'><span class='line'><span class="nc">.products.index</span> <span class="p">{</span>
</span><span class='line'>  <span class="cm">/* some styles */</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-08-29T15:32:00+08:00" pubdate data-updated="true">Aug 29<span>th</span>, 2013</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/tips/'>tips</a>


</div>
	
	<div class="comments"><a href="/blog/articles/2013/08/29/write-css-codes-distinct-from-different-pages/#disqus_thread">Comments</a></div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/articles/2013/08/09/failed-to-stop-or-restart-nginx-server-through-serevice-command/">
		
			Failed to Stop or Restart Nginx Server Through Serevice Command</a>
	</h2>
	<div class="entry-content">
		<p>Many people are accustomed to start a Nginx web server through init scripts and then they can control the state of the server through <code>service</code> command, such as <code>sudo service nginx restart</code>. But sometimes unobvious config error makes the scripts failed to work. Here I will show an error related to <code>pid</code> directive in the config file of nginx, which defaultly located at <code>/opt/nginx/conf/nginx.conf</code>. <br>
As ignored by many people, some init scripts assump there is a pid file of nginx located at <code>/var/run/nginx.pid</code>, but in the fact, the default pid file for nginx is <code>/opt/nginx/logs/nginx.pid</code>. Because the scripts can&rsquo;t get the correct pid or even get nothing, they failed to stop the nginx process, some tasks dependent on it will be failed too, for example, you are not able to restart the server.<br></p>

<p>To resolve this problem, you need to:</p>

<ol>
<li><strong>Force terminating your server through:</strong></li>
</ol>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>sudo service nginx destroy
</span></code></pre></td></tr></table></div></figure>


<ol>
<li><strong>Open your nginx config file to edit:</strong></li>
</ol>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>sudo vim /opt/nginx/conf/nginx.conf
</span></code></pre></td></tr></table></div></figure>


<ol>
<li><strong>Specify the path of your pid file:</strong></li>
</ol>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c"># /opt/nginx/conf/nginx.conf</span>
</span><span class='line'>pid /var/run/nginx.pid
</span></code></pre></td></tr></table></div></figure>


<ol>
<li><strong>After saving your change, start your server now:</strong></li>
</ol>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>sudo service nginx start
</span></code></pre></td></tr></table></div></figure>


<ol>
<li><strong>To confirm that your pid config has taken effect, you can cat your pid file and/or try to restart your server through <code>service</code> command:</strong></li>
</ol>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>cat /var/run/nginx.pid
</span><span class='line'><span class="nv">$ </span>sudo service nginx restart
</span></code></pre></td></tr></table></div></figure>


<p>As expected, you will see the screen out <strong>&ldquo;OK&rdquo;</strong> for your operations.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-08-09T11:39:00+08:00" pubdate data-updated="true">Aug 9<span>th</span>, 2013</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/nginx/'>Nginx</a>


</div>
	
	<div class="comments"><a href="/blog/articles/2013/08/09/failed-to-stop-or-restart-nginx-server-through-serevice-command/#disqus_thread">Comments</a></div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/articles/2013/07/25/export-slash-import-to-slash-from-a-csv-file/">
		
			Export/import Datas To/from a Csv File</a>
	</h2>
	<div class="entry-content">
		<p>今天需要给客户的网站做支持产品数据导出并且更新的功能，所以就涉及到了数据的导入导出了。在经过一番对比之下，果断使用<code>csv</code>格式文件作为数据导入导出的载体。<br></p>

<h4>导出csv文件</h4>

<p>与csv文件主要相关的类是<code>CSV</code>,此类在ruby的标准库中被定义，所以只要在代码开头引入相关文件即可:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;csv&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>接着需要创建csv文件，并在其中写入数据:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">CSV</span><span class="o">.</span><span class="n">open</span> <span class="s2">&quot;path/to/csv/file&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="ss">:col_sep</span> <span class="o">=&gt;</span> <span class="s1">&#39;|&#39;</span> <span class="k">do</span> <span class="o">|</span><span class="n">csv</span><span class="o">|</span>
</span><span class='line'>  <span class="n">csv</span> <span class="o">&lt;&lt;</span> <span class="o">[</span><span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;row&quot;</span><span class="p">,</span> <span class="s2">&quot;of&quot;</span><span class="p">,</span> <span class="s2">&quot;contents&quot;</span><span class="o">]</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong> 这里有几个细节值得一提：</strong><br>
1. <code>open</code>方法是用于对CSV文件进行写操作的主要接口,对CSV文件进行写操作都应该使用此方法;<br>
2. <code>&lt;&lt;</code> 操作符支持将<strong>字符串数组</strong>写入到csv文件,一个数组为一行，数组中的一个字符串为一个单元(field);<br>
3. <code>open</code>方法的第三个参数是一个哈希，用于为打开的文件指定初始化赋值，具体可用的option以及其值可参考<code>new</code>方法的说明:<a href="http://www.ruby-doc.org/stdlib-1.9.3/libdoc/csv/rdoc/CSV.html#method-c-new">http://www.ruby-doc.org/stdlib-1.9.3/libdoc/csv/rdoc/CSV.html#method-c-new</a> <br>
4. <code>:col_sep</code>用于指定文件中每一行中的每个单元之间的分隔符，当通过字符串数组想文件中添加新行的时候，CSV将会在数组元素也就是每一行的单元之间插入指定的分隔符，分隔符需要尽量避开已经在待导出数据中存在的字符，以免后续导入的时候发生歧义。</p>

<h4>导入csv文件</h4>

<p>导入csv除了需要用到相关的类<code>CSV</code>，还可能用到的类是<code>CSV::Row</code>，前者提供打开文件以及将文件按行分隔的方法<code>foreach</code>，foreach将分隔后的行逐行分配到CSV::Row的实例中，通过调用CSV::Row的实例方法<code>field</code>可对每个单元进行读取。<br>
假设我有这样一个csv文件：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">id</span>      <span class="o">|</span>     <span class="n">value</span>
</span><span class='line'><span class="mi">1234</span>      <span class="o">|</span>        <span class="n">hello</span>
</span><span class='line'><span class="mi">2345</span>      <span class="o">|</span>        <span class="n">world</span>
</span></code></pre></td></tr></table></div></figure>


<p>则相关的代码如下：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">CSV</span><span class="o">.</span><span class="n">foreach</span><span class="p">(</span><span class="s1">&#39;path/to/file&#39;</span><span class="p">),</span> <span class="ss">:col_sep</span> <span class="o">=&gt;</span> <span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="ss">:headers</span> <span class="o">=&gt;</span> <span class="ss">:first_row</span> <span class="k">do</span> <span class="o">|</span><span class="n">row</span><span class="o">|</span>
</span><span class='line'>  <span class="c1"># use datas of each row</span>
</span><span class='line'>  <span class="nb">id</span>      <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">field</span> <span class="s1">&#39;id&#39;</span>
</span><span class='line'>  <span class="n">value</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">field</span> <span class="s1">&#39;value&#39;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong> 同样这里也有几个细节需要注意:</strong><br>
1. <code>foreach</code>是CSV类中用于读取文件的标准方法；<br>
2. 通过指定<code>:col_sep =&gt; '|'</code>可使CSV按照指定的分隔符分隔好文件内容，方便后面<code>field</code>方法的调用；<br>
3. 指定<code>:headers =&gt; :first_row</code>可使CSV将第一行视为文件的headers，并且结合<code>:col_sep</code>的设定可以将headers进行分割，这两个是<code>field</code>方法的基础。</p>

<h5>Related links:</h5>

<p><a href="http://www.ruby-doc.org/stdlib-1.9.3/libdoc/csv/rdoc/CSV.html">http://www.ruby-doc.org/stdlib-1.9.3/libdoc/csv/rdoc/CSV.html</a> <br>
<a href="http://www.ruby-doc.org/stdlib-1.9.3/libdoc/csv/rdoc/CSV/Row.html">http://www.ruby-doc.org/stdlib-1.9.3/libdoc/csv/rdoc/CSV/Row.html</a></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-07-25T22:19:00+08:00" pubdate data-updated="true">Jul 25<span>th</span>, 2013</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/csv/'>csv</a>, <a class='category' href='/blog/categories/ruby/'>ruby</a>


</div>
	
	<div class="comments"><a href="/blog/articles/2013/07/25/export-slash-import-to-slash-from-a-csv-file/#disqus_thread">Comments</a></div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/articles/2013/07/24/rails-http-status-code-to-symbol-mapping/">
		
			Rails HTTP Status Code to Symbol Mapping</a>
	</h2>
	<div class="entry-content">
		<p>Sometimes you might need to set the HTTP response head with different status to specify the different handled results. You can do this in Rails by add a <code>:status</code> to a rails method such as <code>#respond_with</code>. Here list all the maps:</p>

<div><script src='https://gist.github.com/2405434.js'></script>
<noscript><pre><code></code></pre></noscript></div>


<p>Addtionally, you can view all these on your local machine by installing the gem <code>cheat</code>, and see all status codes using command <code>cheat status_codes</code>.</p>

<p>All these informations come from internet, the codes file comes from <a href="https://gist.github.com/ktkaushik">ktkaushik&rsquo;s</a> gist and other information comes from <a href="http://www.codyfauser.com/2008/7/4/rails-http-status-code-to-symbol-mapping">Cody Fauser&rsquo;s post</a></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-07-24T15:00:00+08:00" pubdate data-updated="true">Jul 24<span>th</span>, 2013</time></div>
	<div class="tags">

</div>
	
	<div class="comments"><a href="/blog/articles/2013/07/24/rails-http-status-code-to-symbol-mapping/#disqus_thread">Comments</a></div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/articles/2013/07/21/delete-multiple-git-remote-branches-by-prefixing-all-refs-with-a-colon/">
		
			Delete Multiple Git Remote Branches by Prefixing All Refs With a Colon</a>
	</h2>
	<div class="entry-content">
		<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>git push origin :branch-1 :branch-2 <span class="o">[</span>:other-branches<span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Remember the colon <code>:</code></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-07-21T15:46:00+08:00" pubdate data-updated="true">Jul 21<span>st</span>, 2013</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/git/'>Git</a>, <a class='category' href='/blog/categories/tips/'>tips</a>


</div>
	
	<div class="comments"><a href="/blog/articles/2013/07/21/delete-multiple-git-remote-branches-by-prefixing-all-refs-with-a-colon/#disqus_thread">Comments</a></div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/articles/2013/07/21/track-original-repo-when-fork/">
		
			Track Original Repo When Fork</a>
	</h2>
	<div class="entry-content">
		<div><script src='https://gist.github.com/5908916.js'></script>
<noscript><pre><code></code></pre></noscript></div>




		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-07-21T10:24:00+08:00" pubdate data-updated="true">Jul 21<span>st</span>, 2013</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/git/'>Git</a>


</div>
	
	<div class="comments"><a href="/blog/articles/2013/07/21/track-original-repo-when-fork/#disqus_thread">Comments</a></div>
	
</div>
</article>

<nav id="pagenavi">
    
        <a href="/blog/page/3/" class="prev">Prev</a>
    
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav></div>
	<footer id="footer" class="inner">Copyright &copy; 2018

    Martin

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'martin-blog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//go.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-50624776-1']);
		_gaq.push(['_setDomainName','github.io']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>


<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F6d4498d8e2d7328fffdb1539f0589a61' type='text/javascript'%3E%3C/script%3E"));
</script>
<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '781315158664022',
      xfbml      : true,
      version    : 'v2.4'
    });
  };

  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "//connect.facebook.net/en_US/sdk.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
</script>

</body>
</html>